parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"L1Q3":[function(require,module,exports) {
module.exports="/sisisin.12c90bbb.jpg";
},{}],"dNL9":[function(require,module,exports) {
module.exports="/sisisin2048.c8db17d6.jpg";
},{}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"epB2":[function(require,module,exports) {

var process = require("process");
var e=require("process"),t=o(require("./assets/sisisin.jpg")),r=o(require("./assets/sisisin2048.jpg"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=n(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,s=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw s}}}}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var f={keys:[]},h={CELL_WIDTH:100,CELL_HEIGHT:100,CELL_MARGIN:12,ANIMATION_SWELLING:8,ANIMATION_GEN_TIME:100,FONT_SIZE:40},u=function(){function e(){a(this,e),this.board=[],this.merge=[],this.moveCells=[],this.move=-1;for(var t=0;t<16;t++)this.board.push(0),this.merge.push(!1)}return c(e,[{key:"calcNextState",value:function(t){for(var r=new e,o=0;o<16;o++)r.board[o]=this.board[o];return 0==t?r._moveUp():1==t?(r._rotate(3),r._moveUp(),r._rotate(1)):2==t?(r._rotate(2),r._moveUp(),r._rotate(2)):(r._rotate(1),r._moveUp(),r._rotate(3)),this.move=-1,this.moveCells.length>0&&(this.move=t),r}},{key:"isDie",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){if(0===this.board[4*e+t])return!1;for(var r=[1,0],o=[0,1],s=0;s<2;++s){var n=e+o[s],i=t+r[s];if(!(n>=4||i>=4)&&this.board[4*e+t]===this.board[4*n+i])return!1}}return!0}},{key:"getEmptyCells",value:function(){for(var e=[],t=0;t<16;t++)0==this.board[t]&&e.push(t);return e}},{key:"rewriteCells",value:function(e,t,r){this.board[4*e+t]=r}},{key:"_rotate",value:function(e){for(var t=0;t<e;++t){for(var r=[],o=[],s=0;s<16;++s){var n=Math.floor(s/4),i=s-4*n,a=3-n;r[4*i+a]=this.board[s],o[4*i+a]=this.merge[s]}this.board=r,this.merge=o;for(var l=[],c=0;c<this.moveCells.length;++c){var f=this.moveCells[c],h=f.fx,u=f.fy,m=f.tx,y=f.ty;l.push({fx:3-u,fy:h,tx:3-y,ty:m})}this.moveCells=l}}},{key:"_moveUp",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)this.merge[4*e+t]=!1;for(var r=1;r<4;r++)for(var o=0;o<4;++o)if(0!==this.board[4*r+o]){for(var s=r;s>=1;){var n=this.board[4*(s-1)+o];if(0===n)this.board[4*(s-1)+o]=this.board[4*s+o],this.board[4*s+o]=0,--s;else{if(n!==this.board[4*s+o]||this.merge[4*s+o]||this.merge[4*(s-1)+o])break;this.board[4*(s-1)+o]=2*n,this.board[4*s+o]=0,this.merge[4*(s-1)+o]=!0,--s}}s!=r&&this.moveCells.push({fx:o,fy:r,tx:o,ty:s})}}}]),e}(),m=function(){function e(){a(this,e),this.screen=document.getElementById("gameBoard"),this.animation=new y(this.screen),this.state=new u;for(var t=[2,4,8,16,32,64,128,256,512,1024,2048],r=0;r<t.length;r++){var o=this.state.getEmptyCells(),s=t[r],n=o[Math.floor(Math.random()*o.length)],i=Math.floor(n/4),l=n%4;this.state.rewriteCells(i,l,s),this.animation.generate(this.screen,i,l,s,1)}}return c(e,[{key:"move",value:function(e){if(!this.state.isDie()&&this.animation.finish){var t=this.state.calcNextState(e);if(t.moveCells.length>0){var r=t.getEmptyCells(),o=Math.random()<.9?2:4,s=r[Math.floor(Math.random()*r.length)],n=Math.floor(s/4),i=s%4;t.rewriteCells(n,i,o),this.animation.update(t,n,i,o),this.state=t}}}}]),e}(),y=function(){function e(t){a(this,e),this.bottomCells=[],this.cells=[],this.pos=new Map,this.itr=0;for(var r=0;r<16;r++){var o=Math.floor(r/4),s=r%4,n=new v(0,t);n.setPos(o,s),this.bottomCells.push(n)}this.screen=t,this.finish=!0}return c(e,[{key:"update",value:function(e,t,r,o){var n=this;this.finish=!1;var i,a=0,l=h.ANIMATION_GEN_TIME,c=null,f=new Map,u=s(e.moveCells);try{var m=function(){var e=i.value,t=-1;if(n.pos.forEach(function(r,o,s){r.x===e.fx&&r.y===e.fy&&(t=o)}),-1===t)return console.error("cell not found!"),"continue";f.set(t,e)};for(u.s();!(i=u.n()).done;)m()}catch(b){u.e(b)}finally{u.f()}f.forEach(function(e,t,r){n.pos.set(t,{x:e.tx,y:e.ty})});requestAnimationFrame(function e(t){c||(c=t),a=(t-c)/l,(a=Math.min(a,1))>=0&&f.forEach(function(e,t,r){n.cells[t].translate(e.fx,e.fy,e.tx,e.ty,a)}),a<1&&requestAnimationFrame(e)});for(var y=[],d=[],L=function(t){for(var r=function(r){if(e.merge[4*t+r]){var o=[];n.pos.forEach(function(e,s,n){e.x===r&&e.y===t&&o.push(s)}),y.push(o[0]),d.push(o[1])}},o=0;o<4;++o)r(o)},E=0;E<4;++E)L(E);var C=this.itr++;this.pos.set(C,{x:r,y:t});var I=0,_=h.ANIMATION_GEN_TIME,p=null;setTimeout(function i(){p||(p=new Date,n.cells[C]=new v(o,n.screen));var a=new Date;if(I=(a-p)/_,(I=Math.min(I,1))>=0){var l,c=s(d);try{for(c.s();!(l=c.n()).done;){var f=l.value,h=n.pos.get(f);n.cells[f].changeAttrib(e.board[4*h.y+h.x]),n.cells[f].appear(n.pos.get(f).y,n.pos.get(f).x,I,2)}}catch(b){c.e(b)}finally{c.f()}n.cells[C].appear(t,r,I,1)}if(I<1)requestAnimationFrame(i);else{n.finish=!0;var u,m=s(y);try{for(m.s();!(u=m.n()).done;){var L=u.value;n.screen.removeChild(n.cells[L].elem),n.cells[L]=null,n.pos.delete(L)}}catch(b){m.e(b)}finally{m.f()}}},1.1*h.ANIMATION_GEN_TIME)}},{key:"generate",value:function(e,t,r,o){var s=this,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=-1;if(this.pos.forEach(function(e,o,s){e.x===r&&e.y===t&&(i=o)}),-1===i){i=this.itr++,this.cells[i]=new v(o,e),this.pos.set(i,{x:r,y:t});var a=0,l=null,c=h.ANIMATION_GEN_TIME;requestAnimationFrame(function e(o){l||(l=o),a=(o-l)/c,(a=Math.min(a,1))>=0&&s.cells[i].appear(t,r,a,n),a<1&&requestAnimationFrame(e)})}else this.cells[i].changeAttrib(o)}}]),e}(),v=function(){function e(t,r){a(this,e),this.elem=this._initElement(),r.appendChild(this.elem),this.changeAttrib(t)}return c(e,[{key:"translate",value:function(e,t,r,o,s){var n=t+(o-t)*s,i=(e+(r-e)*s)*(h.CELL_WIDTH+h.CELL_MARGIN)+h.CELL_MARGIN,a=n*(h.CELL_HEIGHT+h.CELL_MARGIN)+h.CELL_MARGIN;this.elem.style.left="".concat(i,"px"),this.elem.style.top="".concat(a,"px")}},{key:"setPos",value:function(e,t){this.appear(e,t,0)}},{key:"appear",value:function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=h.CELL_HEIGHT,n=h.CELL_WIDTH,i=e*(h.CELL_HEIGHT+h.CELL_MARGIN)+h.CELL_MARGIN,a=t*(h.CELL_WIDTH+h.CELL_MARGIN)+h.CELL_MARGIN,l=h.FONT_SIZE;1===o?(s=h.CELL_HEIGHT*r,n=h.CELL_WIDTH*r,a=t*(h.CELL_WIDTH+h.CELL_MARGIN)+h.CELL_MARGIN+(h.CELL_WIDTH-n)/2,i=e*(h.CELL_HEIGHT+h.CELL_MARGIN)+h.CELL_MARGIN+(h.CELL_HEIGHT-s)/2,l=h.FONT_SIZE*r):2===o&&(s=h.CELL_HEIGHT+h.ANIMATION_SWELLING*Math.sin(Math.PI*r),n=h.CELL_WIDTH+h.ANIMATION_SWELLING*Math.sin(Math.PI*r),a=t*(h.CELL_WIDTH+h.CELL_MARGIN)+h.CELL_MARGIN+(h.CELL_WIDTH-n)/2,i=e*(h.CELL_HEIGHT+h.CELL_MARGIN)+h.CELL_MARGIN+(h.CELL_HEIGHT-s)/2,l=h.FONT_SIZE*(s/h.CELL_HEIGHT)),this.elem.style.left="".concat(a,"px"),this.elem.style.top="".concat(i,"px"),this.elem.style.height="".concat(s,"px"),this.elem.style.width="".concat(n,"px"),this.elem.style.fontSize="".concat(l,"px"),this.elem.style.lineHeight="".concat(s,"px")}},{key:"changeAttrib",value:function(e){if(this.elem.textContent=e>0?e:"",0===e){var o=document.createElement("img");o.src=t.default,o.width="100",this.elem.style.backgroundImage='url("'.concat(r.default,'")'),this.elem.style.backgroundSize="cover"}switch(this.num=e,e){case 0:this.elem.style.backgroundColor="#ccc",this.elem.style.color="#000";break;case 2:this.elem.style.backgroundColor="#eee",this.elem.style.color="#000";break;case 4:this.elem.style.backgroundColor="#eec",this.elem.style.color="#000";break;case 8:this.elem.style.backgroundColor="#f93",this.elem.style.color="#fff";break;case 16:this.elem.style.backgroundColor="#c66",this.elem.style.color="#fff";break;case 32:this.elem.style.backgroundColor="#c33",this.elem.style.color="#fff";break;case 64:this.elem.style.backgroundColor="#c11",this.elem.style.color="#fff";break;case 128:this.elem.style.backgroundColor="#fc6",this.elem.style.color="#fff";break;case 256:this.elem.style.backgroundColor="#fc5",this.elem.style.color="#fff";break;case 512:this.elem.style.backgroundColor="#fc3",this.elem.style.color="#fff";break;case 1024:this.elem.style.backgroundColor="#fc1",this.elem.style.color="#fff";break;case 2048:this.elem.style.backgroundColor="#fc0",this.elem.style.color="#fff";break;default:this.elem.style.backgroundColor="#222",this.elem.style.color="#fff"}}},{key:"_initElement",value:function(){var e=document.createElement("div");return e.classList.add("gameCell"),e}}]),e}(),d=new m;document.addEventListener("keydown",function(e){if(f.keys[e.keyCode]=!0,f.keys[38])d.move(0);else if(f.keys[39])d.move(1);else if(f.keys[40])d.move(2);else{if(!f.keys[37])return;d.move(3)}}),document.addEventListener("keyup",function(e){f.keys[e.keyCode]=!1});
},{"./assets/sisisin.jpg":"L1Q3","./assets/sisisin2048.jpg":"dNL9","process":"pBGv"}]},{},["epB2"], null)
//# sourceMappingURL=/main.59f7486c.js.map